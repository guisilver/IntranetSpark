<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">
	<style>
.msg {
	color: #FFF;
	font-size: 20px;
}

#frmFiltro table td {
	border: 0px !important;
}

.ui-selectoneradio tbody tr td {
	border: 0px !important;
}

.gridFiltro tbody tr td {
	border: 0px !important;
}
</style>
	<div class="layout-portlets-box"
		style="padding-top: 0px !important; padding-bottom: 0px !important;">
		<p:breadCrumb>
			<p:menuitem value="Home" url="/dashboard.xhtml" />
			<p:menuitem value="Nova Emissão" url="/emissao/gerencia/nova-emissao" />
		</p:breadCrumb>
	</div>

	<div class="layout-portlets-box">
		<div class="DispInlBlock TexAlLeft">
			<div class="Fleft">
				<h2 class="black Fs24 FontRalewayMedium">Emissões Mensais</h2>
			</div>
		</div>
		<div class="Seperator"></div>
		<div class="Container50 Responsive50">
			<div class="ContainerIndent">
				<h:form rendered="#{SessaoMB.igp.sysAdmin || SessaoMB.igp.sysSEM}">
					<p:messages id="msg" showDetail="true" autoUpdate="false"
						closable="true" escape="true" showSummary="false" styleClass="msg" />
					<p:growl autoUpdate="true" id="growl" widgetVar="growl" />
					<p:panelGrid columns="4" styleClass="gridFiltro">
						<f:facet name="header">
							<h:outputText value="Filtros" />
						</f:facet>
						<p:outputLabel value="Cota:" />
						<p:selectOneMenu value="#{emMB.mes}" style="width:100px;">
							<f:selectItem itemLabel="Janeiro" itemValue="1" />
							<f:selectItem itemLabel="Fevereiro" itemValue="2" />
							<f:selectItem itemLabel="Março" itemValue="3" />
							<f:selectItem itemLabel="Abril" itemValue="4" />
							<f:selectItem itemLabel="Maio" itemValue="5" />
							<f:selectItem itemLabel="Junho" itemValue="6" />
							<f:selectItem itemLabel="Julho" itemValue="7" />
							<f:selectItem itemLabel="Agosto" itemValue="8" />
							<f:selectItem itemLabel="Setembro" itemValue="9" />
							<f:selectItem itemLabel="Outubro" itemValue="10" />
							<f:selectItem itemLabel="Novembro" itemValue="11" />
							<f:selectItem itemLabel="Dezembro" itemValue="12" />
							<p:ajax update="@all" />
						</p:selectOneMenu>
						<p:commandButton value="Filtrar"
							action="#{emMB.pesquisarPorData()}"
							update=":frmTblEmissao:tblEmissao"
							onstart="PF('dlgStatus').show();"
							oncomplete="PF('dlgStatus').hide();"
							icon="fa fa-search Fs16 white">
							<p:ajax listener="#{emMB.testeMeses()}" update="@all" />
						</p:commandButton>
					</p:panelGrid>
					<br />
				</h:form>
			</div>
		</div>

		<div class="Container100 TexAlCenter">
			<div class="ContainerIndent">
				<h:form id="frmTblEmissao"
					rendered="#{SessaoMB.igp.sysAdmin || SessaoMB.igp.sysSEM}">
					<p:dataTable id="tblEmissao" var="emissao"
						value="#{emMB.listaEmissoes}"
						selection="#{emMB.listarEmissoesSelecionadas}" rows="30"
						rowKey="#{emissao.id}" paginator="true"
						style="font-size:12px; text-align:center;heigth:600px;"
						emptyMessage="Não existe emissões para esse gerente!">
						<f:facet name="header"> Emissões</f:facet>
						<f:facet name="footer">
							<hr />
							<p:commandButton value="Gerar Próximo Mês"
								icon="fa fa-check Fs16 white" action="#{emMB.gerarProximoMes()}"
								ajax="false" />
						</f:facet>
						<p:column rendered="false">
							<p:outputLabel value="#{requisicao}" />
						</p:column>
						<p:column selectionMode="multiple"
							style="width:16px;text-align:center;" />
						<p:column headerText="Condomínio">
							<h:outputText
								value="#{emissao.codigo_condominio} - #{emissao.nome_condominio}" />
						</p:column>
						<p:column headerText="Nº Emissão">
							<h:outputText value="#{emissao.nroEmissao}" />
						</p:column>
						<p:column headerText="Vencimento">
							<h:outputText value="#{emissao.vencimento}">
								<f:convertDateTime locale="pt" pattern="dd/MM/yyyy"
									timeZone="America/Sao_Paulo" />
							</h:outputText>
						</p:column>
						<p:column headerText="Correio:">
							<h:outputText value="Sim" rendered="#{emissao.correio eq true}" />
							<h:outputText value="Não" rendered="#{emissao.correio eq false}" />
						</p:column>
						<p:column headerText="Liberação para Emissão:">
							<h:outputText value="#{emissao.liberacao_gerente}">
								<f:convertDateTime locale="pt" pattern="dd/MM/yyyy"
									timeZone="America/Sao_Paulo" />
							</h:outputText>
						</p:column>
						<p:column headerText="Data da Impressão">
							<h:outputText value="#{emissao.data_impressao}">
								<f:convertDateTime locale="pt" pattern="dd/MM/yyyy"
									timeZone="America/Sao_Paulo" />
							</h:outputText>
						</p:column>
						<p:column headerText="Liberação para a Expedição:">
							<h:outputText value="#{emissao.liberacao_expedicao}">
								<f:convertDateTime locale="pt" pattern="dd/MM/yyyy"
									timeZone="America/Sao_Paulo" />
							</h:outputText>
						</p:column>
						<p:column headerText="Liberação para o Prédio:">
							<h:outputText value="#{emissao.envio_predio}">
								<f:convertDateTime locale="pt" pattern="dd/MM/yyyy"
									timeZone="America/Sao_Paulo" />
							</h:outputText>
						</p:column>
						<p:column headerText="Detalhes"
							footerText="Qnt. Emissões: #{emMB.quantidadeEmissoes()}">
							<p:commandButton
								actionListener="#{emMB.listarEmissaoPorCondominio(emissao.id)}"
								oncomplete="PF('dlgConsultar').show();"
								update=":frmConsRateio:tblConsultar"
								icon="fa fa-search Fs16 white" styleClass="btnLittle" />
							<p:commandButton oncomplete="PF('dlgExclusao').show();"
								style="margin-left:5px !important;" styleClass="btnLittle"
								icon="fa fa-trash Fs16 white">
								<f:setPropertyActionListener value="#{emissao}"
									target="#{emMB.emcSelecionado}" />
							</p:commandButton>
						</p:column>
					</p:dataTable>
					<p:dialog widgetVar="dlgStatus" id="dlgStatus" header="Status"
						style="font-size:13px;" resizable="false" modal="true"
						closable="false">	
						Esta pesquisa pode levar alguns segundos.<br />
						Carregando...<br />
						<br />
						<p:graphicImage library="imagens" name="loader.gif" />
						<br />
					</p:dialog>

					<script type="text/javascript">
						function start() {
							PF('statusDialog').show();
						}
						function stop() {
							PF('statusDialog').hide();
							PF('relatorio').hide();
						}
					</script>
				</h:form>
			</div>
		</div>
	</div>
	<ui:include src="/emissao/gerencia/dialog-consultar-rateio.xhtml" />
	<ui:include src="/emissao/gerencia/dialog-cancelar-rateio.xhtml" />
</ui:composition>