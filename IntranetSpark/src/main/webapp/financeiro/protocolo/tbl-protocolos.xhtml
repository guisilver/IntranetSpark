<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
	
<style>
.Recebido {
	color: green;
}

.Pendente {
	color: blue;
}

.gridAcoes>tbody td {
	border: 0px !important;
}
</style>
	<h:form id="frmTblProtocolo">

		<h:panelGrid style="width:auto;margin-left:auto;margin-right:auto;">
			<h:panelGrid columns="4">
				<p:commandButton value="Novo protocolo" icon="fa fa-plus Fs16 white"
					actionListener="#{ProtGEDMB.abreDlgNovoProtocolo()}"
					update=":frmNovoProtocolo" />
				<p:commandButton value="Alterar Obs" icon="fa fa-pencil Fs16 white"
					actionListener="#{ProtGEDMB.abrirDlgObs()}" update=":frmObs" />
				<h:panelGrid columns="2">
					<p:outputLabel value="Situação:" />
					<p:selectOneMenu effect="none" value="#{ProtGEDMB.listarPor}"
						id="menuStatus" style="margin-right:10px;">
						<p:ajax event="change"
							listener="#{ProtGEDMB.listarProtocolos()}"
							update=":frmTblProtocolo:tblProtocolos" />
						<f:selectItem itemLabel="Pendentes" itemValue="P" />
						<f:selectItem itemLabel="Recebidos" itemValue="R" />
						<f:selectItem itemLabel="Todos" itemValue="T" />
					</p:selectOneMenu>
				</h:panelGrid>
			</h:panelGrid>

			<p:dataTable var="item" emptyMessage="Não há registros."
				id="tblProtocolos" rows="10" value="#{ProtGEDMB.lstProtocolos}"
				rowKey="#{item.codigo}"
				selection="#{ProtGEDMB.protocolo}"
				rowsPerPageTemplate="5,10,15,20,25,30,50,100" paginator="true"
				style="width:1000px;margin-top:20px;">
				<p:column headerText="Código" rendered="false">
					<h:outputText value="#{item.codigo}" />
				</p:column>
				<p:column headerText="Data">
					<h:outputText value="#{item.data}">
						<f:convertDateTime pattern="dd/MM/yyyy" locale="pt"
							timeZone="America/Sao_Paulo" />
					</h:outputText>
				</p:column>

				<p:column headerText="Qtd. Arquivos" style="text-align:center;">
					<h:outputText value="#{item.lancamentos.size()}" />
				</p:column>

				<p:column headerText="Situação" style="text-align:center;">
					<p:outputLabel
						value="#{ProtGEDMB.verificaSituacaoProtocolo(item) ? 'Recebido' : 'Pendente'}"
						styleClass="#{ProtGEDMB.verificaSituacaoProtocolo(item) ? 'Recebido' : 'Pendente'}" />
				</p:column>

				<p:column headerText="Ações" style="width:120px;">
					<h:panelGrid id="gridAcoes" styleClass="gridAcoes" columns="2"
						border="0" style="width:100px;">
						<h:column style="border:0px!important;">
							<p:commandButton icon="fa fa-search Fs16 white"
								actionListener="#{ProtGEDMB.abreDlgDetalhesProtocolo(item.codigo)}"
								update=":frmDetalhesProtocolo">
								<f:setPropertyActionListener target="#{ProtGEDMB.protocolo}"
									value="#{item}" />
							</p:commandButton>
						</h:column>

						<h:column style="border:0px!important;"	rendered="#{!ProtGEDMB.verificaSituacaoProtocolo(item)}">
							<p:commandButton icon="fa fa-trash Fs16 white"
								onclick="PF('dlgExclui').show();">
								<f:setPropertyActionListener target="#{ProtGEDMB.protocolo}"
									value="#{item}" />
							</p:commandButton>
						</h:column>
					</h:panelGrid>
				</p:column>

			</p:dataTable>
		</h:panelGrid>

	</h:form>
</ui:composition>