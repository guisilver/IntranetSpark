<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="/WEB-INF/template.xhtml">
	<ui:define name="content">
<style>
.noBorder tbody tr td {
	border: 0px !important;
}

#frmFiltros\3a panelGraficos>tbody>tr>td {
	vertical-align: top !important;
}

.section {
	clear: both;
	padding: 0px;
	margin: 0px;
}

/*  COLUMN SETUP  */
.col {
	display: block;
	float: left;
	margin-top: 10px;
	margin-left: 5px;
}

.col:first-child {
	margin-left: 0;
}

/*  GROUPING  */
.group:before, .group:after {
	content: "";
	display: table;
}

.group:after {
	clear: both;
}

.group {
	zoom: 1; /* For IE 6/7 */
}

/*  GRID OF THREE  */
.span_3_of_3 {
	width: 100%;
}

.span_2_of_3 {
	width: auto;
}

.span_1_of_3 {
	width: 32.2%;
	color: white;
	font-weight: bold;
}

/*  GO FULL WIDTH AT LESS THAN 780 PIXELS */
@media only screen and (max-width: 780px) {
	.col {
		margin: 1% 0 1% 0%;
	}
}

@media only screen and (min-width: 1051px) {
	.group {
		width: 85% !important;
	}
}

@media only screen and (max-width: 1050px) {
	.ui-galleria-panel-wrapper {
		width: 100% !important;
	}
	.group {
		width: 100% !important;
	}
}

@media only screen and (max-width: 780px) {
	.span_3_of_3 {
		width: 100%;
		padding-bottom: 10px;
	}
	.span_2_of_3 {
		width: 100%;
		padding-bottom: 10px;
	}
	.span_1_of_3 {
		width: 100%;
		padding-bottom: 10px;
	}
}
</style>
		<div class="layout-portlets-box">
			<div class="DispInlBlock TexAlLeft">
				<div class="Fleft">
					<h2 class="black Fs24 FontRalewayMedium">Contábil - Gráfico
						Comparativo</h2>
				</div>
			</div>
			<div class="Seperator"></div>
			<div class="Container100 Responsive100">
				<div class="ContainerIndent">
					<p:messages autoUpdate="true" />
					<h:form id="frmFiltros">
						<p:panelGrid columns="2" style="margin:10px;">
						
							<f:facet name="header">
								Filtros
							</f:facet>
							
							<p:outputLabel value="Gerente: " for="gerente" rendered="#{!SessaoMB.verificaDepto(' Todos')}" />
							<p:selectOneMenu filter="true" id="gerente"
								filterMatchMode="contains" value="#{grafCompMB.gerente}"
								converter="omnifaces.SelectItemsConverter" style="width:200px;"
								required="true" requiredMessage="Insira o gerente!" rendered="#{!SessaoMB.verificaDepto(' Todos')}">
								<p:ajax listener="#{grafCompMB.listarCondominios()}" update=":frmFiltros" resetValues="true" />
								<f:selectItem itemLabel="Nenhum" noSelectionOption="true" />
								<f:selectItems var="gerente" value="#{graficosMB.listaGerentes}"
									itemLabel="#{gerente.nome}" itemValue="#{gerente}" />
							</p:selectOneMenu>
							
							<p:outputLabel for="console" value="Condomínio:" />
							<p:selectOneMenu id="console"
								value="#{grafCompMB.condominioSelecionado}" style="width:200px"
								filter="true" filterMatchMode="contains"
								converter="omnifaces.SelectItemsConverter" required="true"
								requiredMessage="Insira o condomínio!">
								<f:selectItem itemLabel="Selecione" noSelectionOption="true" />
								<f:selectItems value="#{graficosMB.listaCondominios}" var="item"
									itemLabel="#{item.cndCodNome}" itemValue="#{item}" />
							</p:selectOneMenu>
							
							<h:outputText value="Data" />
							<h:panelGrid columns="3" styleClass="noBorder">
								<p:selectOneMenu value="#{grafCompMB.mesFim}"
									style="width:100px;">
									<f:selectItem itemLabel="Janeiro" itemValue="1" />
									<f:selectItem itemLabel="Fevereiro" itemValue="2" />
									<f:selectItem itemLabel="Março" itemValue="3" />
									<f:selectItem itemLabel="Abril" itemValue="4" />
									<f:selectItem itemLabel="Maio" itemValue="5" />
									<f:selectItem itemLabel="Junho" itemValue="6" />
									<f:selectItem itemLabel="Julho" itemValue="7" />
									<f:selectItem itemLabel="Agosto" itemValue="8" />
									<f:selectItem itemLabel="Setembro" itemValue="9" />
									<f:selectItem itemLabel="Outubro" itemValue="10" />
									<f:selectItem itemLabel="Novembro" itemValue="11" />
									<f:selectItem itemLabel="Dezembro" itemValue="12" />
								</p:selectOneMenu>
								<p:selectOneMenu value="#{grafCompMB.anoFim}"
									style="width:80px;">
									<f:selectItem itemLabel="2010" itemValue="2010" />
									<f:selectItem itemLabel="2011" itemValue="2011" />
									<f:selectItem itemLabel="2012" itemValue="2012" />
									<f:selectItem itemLabel="2013" itemValue="2013" />
									<f:selectItem itemLabel="2014" itemValue="2014" />
									<f:selectItem itemLabel="2015" itemValue="2015" />
									<f:selectItem itemLabel="2016" itemValue="2016" />
								</p:selectOneMenu>
								<p:commandButton icon="fa fa-search Fs16 white" value="Filtrar"
									action="#{grafCompMB.filtrar()}" process="@form" update="@form" />
							</h:panelGrid>
							
							<h:outputText value="Período" />
							<p:selectOneMenu value="#{grafCompMB.periodoComparacao}"
								style="width:100px;">
								<f:selectItem itemLabel="3 Meses" itemValue="2" />
								<f:selectItem itemLabel="6 Meses" itemValue="5" />
								<f:selectItem itemLabel="12 Meses" itemValue="11" />
							</p:selectOneMenu>
							
						</p:panelGrid>
						
						<p:panel
							style="display:#{grafCompMB.capasDozeMeses != null ? 'block' : 'none'};">
							<p:tabMenu activeIndex="#{param.i}"
								style="margin:0px!important;position:relative;">
								<c:forEach items="#{grafCompMB.capasDozeMeses}" var="capa"
									varStatus="status">
									<p:menuitem value="#{capa.nome}"
										action="#{grafCompMB.setCapas(capa)}" update="@form">
										<f:param name="i" value="#{status.count - 1}" />
									</p:menuitem>
								</c:forEach>
							</p:tabMenu>
							<div class="section group">
								<div class="col span_2_of_3">
									<p:panelGrid columns="1">
										<f:facet name="header">
											<h:outputText value="#{grafCompMB.titleGraficoMesAtual}" />
										</f:facet>
										<pe:gChart value="#{grafCompMB.geraGraficoMesAtual}"
											width="650" height="400" />
										<p:dataTable value="#{grafCompMB.capaMesAtual.contas}"
											var="conta" style="width:650px;"
											emptyMessage="Nenhum resultado encontrado!">
											<p:column headerText="Conta">
												<h:outputText value="#{conta.nome}" />
											</p:column>
											<p:column headerText="Valor">
												<h:outputText value="#{conta.valorToral}">
													<f:convertNumber type="currency" currencySymbol="R$" />
												</h:outputText>
											</p:column>
											<p:column headerText="%"
												style="text-align:center;width:40px;">
												<h:outputText
													value="#{grafCompMB.calculaPercentual(grafCompMB.capaMesAtual.contas,conta.valorToral)}">
													<f:convertNumber maxFractionDigits="1" />
												</h:outputText>%
										</p:column>
										</p:dataTable>
									</p:panelGrid>
								</div>
								<div class="col span_2_of_3">
									<p:panelGrid columns="1">
										<f:facet name="header">
											<h:outputText value="#{grafCompMB.titleGraficoDozeMeses}" />
										</f:facet>
										<pe:gChart value="#{grafCompMB.geraGraficoDozeMeses}"
											width="650" height="400" />
										<p:dataTable value="#{grafCompMB.capaDozeMeses.contas}"
											var="conta" style="width:650px;"
											emptyMessage="Nenhum resultado encontrado!">
											<p:column headerText="Conta">
												<h:outputText value="#{conta.nome}" />
											</p:column>
											<p:column headerText="Valor">
												<h:outputText value="#{conta.valorToral}">
													<f:convertNumber type="currency" currencySymbol="R$" />
												</h:outputText>
											</p:column>
											<p:column headerText="%"
												style="text-align:center;width:40px;">
												<h:outputText value="#{grafCompMB.calculaPercentual(grafCompMB.capaDozeMeses.contas,conta.valorToral)}">
													<f:convertNumber maxFractionDigits="1" />
												</h:outputText>%
											</p:column>
										</p:dataTable>
									</p:panelGrid>
								</div>
							</div>
						</p:panel>
						
					</h:form>
				</div>
			</div>
		</div>
		<p:ajaxStatus onstart="PF('statusDialog').show()"
			onsuccess="PF('statusDialog').hide()" />
		<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
			closable="false" resizable="false" showHeader="false">
					Carregando...<br />
			<br />
			<p:graphicImage library="imagens" name="loader.gif" />
		</p:dialog>
	</ui:define>
</ui:composition>