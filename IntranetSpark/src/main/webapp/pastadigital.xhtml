<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="/WEB-INF/template.xhtml">
	<ui:define name="content">

		<style>
.noBorder tbody tr td {
	border: 0px !important;
}

.ui-tabs-left>.ui-tabs-nav {
	height: 100% !important;
}
</style>
		<div class="layout-portlets-box">
			<div class="DispInlBlock TexAlLeft">
				<div class="Fleft">
					<h2 class="black Fs24 FontRalewayMedium">Contábil - Pasta
						Digital</h2>
				</div>
			</div>
			<div class="Seperator"></div>
			<div class="Container100 Responsive100">
				<div class="ContainerIndent">
					<p:messages autoUpdate="true" />
					<h:form id="frmFiltros">
						<p:panelGrid id="gridFiltro" columns="1"
							style="margin-bottom:20px;">
							<f:facet name="header">
								<h:outputText value="Filtros" />
							</f:facet>
							<h:panelGrid columns="2" border="0" styleClass="noBorder"
								style="border:0px white;">
								<p:outputLabel for="console" value="Condomínio:" />
								<p:selectOneMenu id="console"
									value="#{pastaDigitalMB.condominioSelecionado}"
									style="width:200px" filter="true" filterMatchMode="contains"
									converter="omnifaces.SelectItemsConverter" required="true"
									requiredMessage="Insira o condomínio!">
									<f:selectItem itemLabel="Selecione" noSelectionOption="true" />
									<f:selectItems value="#{SessaoMB.listaCondominios}" var="item"
										itemLabel="#{item.cndCodNome}" itemValue="#{item}" />
								</p:selectOneMenu>
							</h:panelGrid>
							<h:outputText value="Período" />
							<p:column>
								<h:panelGrid columns="3" styleClass="noBorder">
									<p:selectOneMenu value="#{pastaDigitalMB.mesInicio}"
										style="width:100px;">
										<f:selectItem itemLabel="Janeiro" itemValue="1" />
										<f:selectItem itemLabel="Fevereiro" itemValue="2" />
										<f:selectItem itemLabel="Março" itemValue="3" />
										<f:selectItem itemLabel="Abril" itemValue="4" />
										<f:selectItem itemLabel="Maio" itemValue="5" />
										<f:selectItem itemLabel="Junho" itemValue="6" />
										<f:selectItem itemLabel="Julho" itemValue="7" />
										<f:selectItem itemLabel="Agosto" itemValue="8" />
										<f:selectItem itemLabel="Setembro" itemValue="9" />
										<f:selectItem itemLabel="Outubro" itemValue="10" />
										<f:selectItem itemLabel="Novembro" itemValue="11" />
										<f:selectItem itemLabel="Dezembro" itemValue="12" />
									</p:selectOneMenu>
									<p:selectOneMenu value="#{pastaDigitalMB.anoInicio}"
										style="width:80px;">
										<f:selectItem itemLabel="2010" itemValue="2010" />
										<f:selectItem itemLabel="2011" itemValue="2011" />
										<f:selectItem itemLabel="2012" itemValue="2012" />
										<f:selectItem itemLabel="2013" itemValue="2013" />
										<f:selectItem itemLabel="2014" itemValue="2014" />
										<f:selectItem itemLabel="2015" itemValue="2015" />
										<f:selectItem itemLabel="2016" itemValue="2016" />
									</p:selectOneMenu>
									<p:commandButton icon="fa fa-search Fs16 white" value="Filtrar"
										actionListener="#{pastaDigitalMB.filtrar()}" process="@form"
										update=":frmContas" />
								</h:panelGrid>
							</p:column>
						</p:panelGrid>
					</h:form>
					<h:form id="frmContas">
						<p:tabView id="tabCapas" value="#{pastaDigitalMB.capas}"
							var="capa" activeIndex="#{pastaDigitalMB.tabCapasIndex}"
							rendered="#{pastaDigitalMB.capas.size() > 0}" style="width:auto;"
							dynamic="true">
							<p:ajax event="tabChange"
								listener="#{pastaDigitalMB.pesquisaPrimeraConta(capa.contas.get(0))}"
								update=":frmContas:tabCapas" />
							<p:tab title="#{capa.nome}">
								<p:tabView id="tabContas" orientation="left" var="conta"
									value="#{capa.contas}"
									activeIndex="#{pastaDigitalMB.tabContasIndex}"
									styleClass="tabContas"
									style="font-size:13px;height:auto!important;width:auto;">
									<p:ajax event="tabChange"
										listener="#{pastaDigitalMB.pesquisaLancamentosTab(conta)}"
										update="@this" />
									<p:tab title="#{conta.nome}" style="width:auto;">
										<h:panelGrid>
											<h:panelGrid columns="2" style="margin:15px;">
												<h:outputText value="Conta: " style="color:red;" />
												<h:outputText value="#{pastaDigitalMB.conta.nome}" />
												<h:outputText value="Mês: " style="color:red;" />
												<h:outputText value="#{pastaDigitalMB.dataInicio}">
													<f:convertDateTime pattern="MM/yyyy" locale="pt"
														timeZone="America/Sao_Paulo" />
												</h:outputText>
												<h:outputText value="Valor Total: " style="color:red;" />
												<h:outputText id="valor"
													value="#{pastaDigitalMB.getValorTotalPeriodo()}">
													<f:convertNumber type="currency" currencySymbol="R$" />
												</h:outputText>
											</h:panelGrid>
											<p:dataTable var="item" id="tblContas"
												value="#{pastaDigitalMB.lancamentosMes}"
												style="width:640px;margin-bottom:20px;" scrollable="true"
												scrollHeight="400">
												<f:facet name="header">
											Lançamentos										
										</f:facet>
												<p:column headerText="Data" style="text-align:center;">
													<h:outputText value="#{item.data}"
														rendered="#{!item.sintetico}">
														<f:convertDateTime pattern="dd/MM/yyyy" locale="pt"
															timeZone="America/Sao_Paulo" />
													</h:outputText>
													<h:outputText value="#{item.data}"
														rendered="#{item.sintetico}">
														<f:convertDateTime pattern="MM/yyyy" locale="pt"
															timeZone="America/Sao_Paulo" />
													</h:outputText>
												</p:column>
												<p:column headerText="Conta" style="text-align:center;">
													<h:outputText value="#{item.conta}" />
												</p:column>
												<p:column headerText="Histórico">
													<h:outputText value="#{item.historico}" />
												</p:column>
												<p:column headerText="Valor">
													<h:outputText value="#{item.valor}">
														<f:convertNumber type="currency" />
													</h:outputText>
												</p:column>
												<p:column headerText="Docs"
													style="text-align:center;width:50px;">
													<p:commandButton icon="fa fa-search Fs16 white"
														actionListener="#{pastaDigitalMB.pesquisaDoctosLancto(item)}"
														rendered="#{item.possuiDocs}"
														oncomplete="PF('dlgDocto').show();" update=":frmDocto" />
												</p:column>
											</p:dataTable>
										</h:panelGrid>
									</p:tab>
								</p:tabView>
							</p:tab>
						</p:tabView>
					</h:form>


				</div>
			</div>

			<p:dialog widgetVar="dlgDocto" modal="true" resizable="false"
				header="Documento">
				<h:form id="frmDocto">
					<h:panelGrid id="tblDocto" columns="2" style="vertical-align:top;">
						<p:dataTable id="tblDoctos" var="item"
							value="#{pastaDigitalMB.listaDoctos}"
							emptyMessage="Nenhum resultado encontrado." style="width:200px;"
							scrollable="true" scrollHeight="250" rowKey="#{item}"
							rendered="#{pastaDigitalMB.listaDoctos.size()>1}">
							<f:facet name="header">
								<h:outputText value="Documentos" />
							</f:facet>
							<p:column headerText="Nome">
								<h:outputText value="#{item.nome}" />
							</p:column>
							<p:column style="width:50px;">
								<p:commandButton icon="fa fa-search Fs16 white"
									update=":frmDocto:gridMedia">
									<f:setPropertyActionListener
										target="#{pastaDigitalMB.doctoSelecionado}" value="#{item}" />
								</p:commandButton>
							</p:column>
						</p:dataTable>
						<p:panel id="gridMedia">
							<f:facet name="header">
								<h:outputText value="Nome:" />
								<h:outputText value="#{pastaDigitalMB.doctoSelecionado.nome}" />
							</f:facet>
							<p:media player="pdf" value="#{doctoServiceMB.doctoLancto}"
								width="800" height="600" cache="false"
								rendered="#{pastaDigitalMB.doctoSelecionado != null}">
								<f:param name="idDocto"
									value="#{pastaDigitalMB.doctoSelecionado.id}" />
							</p:media>
						</p:panel>
					</h:panelGrid>
				</h:form>
			</p:dialog>
		</div>

		<p:ajaxStatus onstart="PF('statusDialog').show()"
			onsuccess="PF('statusDialog').hide()" />
		<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
			closable="false" resizable="false" showHeader="false">
					Carregando...<br />
			<br />
			<p:graphicImage library="imagens" name="loader.gif" />
		</p:dialog>
	</ui:define>
</ui:composition>
