<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">
	<style>
#frmFiltro\3a gridPeriodo>tbody td {
	border: 0px !important;
}
</style>
	<div class="Container100 Responsive100">
		<div class="ContainerIndent">
			<h:form id="frmFiltro">
				<p:growl autoUpdate="true" />
				<p:panelGrid id="gridFiltro" columns="1"
					style="border:1px solid white;">
					<f:facet name="header">
						<h:outputText value="Filtros" />
					</f:facet>
					<h:panelGrid columns="2" border="0" id="gridPeriodo">
						<p:outputLabel for="pesquisarPor" value="Pesquisar Por:" />
						<p:selectOneRadio id="pesquisarPor"
							value="#{taxaInadimplenciaMB.pesquisarPor}">
							<p:ajax listener="#{taxaInadimplenciaMB.limparListas()}"
								update=":frmFiltro:gridFiltro" />
							<f:selectItem itemLabel="Condomínio" itemValue="Condominio" />
							<f:selectItem itemLabel="Carteira" itemValue="Carteira" />
							<c:if test="#{SessaoMB.usuario.grupoGer.get(0).nome == ' Todos'}">
								<f:selectItem itemLabel="Todos" itemValue="Todos" />
							</c:if>
						</p:selectOneRadio>

						<p:outputLabel for="agruparPorMes" value="Agrupar por mês:"
							rendered="#{taxaInadimplenciaMB.pesquisarPor eq 'Carteira' or taxaInadimplenciaMB.pesquisarPor eq 'Todos'}" />
						<p:selectBooleanCheckbox id="agruparPorMes"
							value="#{taxaInadimplenciaMB.agruparPorMes}"
							rendered="#{taxaInadimplenciaMB.pesquisarPor eq 'Carteira' or taxaInadimplenciaMB.pesquisarPor eq 'Todos'}" />

						<p:outputLabel id="txtCarteira" for="selectCarteira"
							value="Carteira:"
							rendered="#{taxaInadimplenciaMB.pesquisarPor eq 'Carteira'}" />
						<p:selectOneMenu id="selectCarteira"
							value="#{SessaoMB.gerenteSelecionado}"
							rendered="#{taxaInadimplenciaMB.pesquisarPor eq 'Carteira'}"
							converter="omnifaces.SelectItemsConverter" style="width:95%;"
							filter="true" filterMatchMode="contains">
							<f:selectItem itemLabel="Carteira" noSelectionOption="true" />
							<f:selectItems var="gerente"
								value="#{taxaInadimplenciaMB.listaGerentes}"
								itemLabel="#{gerente.nome}" itemValue="#{gerente}" />
						</p:selectOneMenu>

						<p:outputLabel id="txtGerente" for="selectGerente"
							value="Gerente:"
							rendered="#{taxaInadimplenciaMB.renderizaMenuGerente}" />
						<p:selectOneMenu id="selectGerente"
							value="#{SessaoMB.gerenteSelecionado}"
							rendered="#{taxaInadimplenciaMB.renderizaMenuGerente}"
							converter="omnifaces.SelectItemsConverter" style="width:95%;">
							<p:ajax listener="#{taxaInadimplenciaMB.listarCondominios}"
								update=":frmFiltro" resetValues="true" />
							<f:selectItem itemLabel="Gerente" noSelectionOption="true" />
							<f:selectItems var="gerente"
								value="#{taxaInadimplenciaMB.listaGerentes}"
								itemLabel="#{gerente.nome}" itemValue="#{gerente}" />
						</p:selectOneMenu>

						<p:outputLabel id="txtCondominio" for="selectCondominio"
							value="Condomínio:"
							rendered="#{taxaInadimplenciaMB.pesquisarPor eq 'Condominio'}" />
						<p:selectOneMenu id="selectCondominio"
							value="#{taxaInadimplenciaMB.condominio}"
							rendered="#{taxaInadimplenciaMB.pesquisarPor eq 'Condominio'}"
							converter="omnifaces.SelectItemsConverter" filter="true"
							filterMatchMode="contains" style="width:95%;">
							<f:selectItem itemLabel="Condomínio" noSelectionOption="true" />
							<f:selectItems var="cnd"
								value="#{taxaInadimplenciaMB.listaCondominios}"
								itemLabel="#{cnd.codigo} - #{cnd.nome}" itemValue="#{cnd}" />
						</p:selectOneMenu>

						<h:outputText value="Data Início" />
						<p:column>
							<h:panelGrid columns="2">
								<p:selectOneMenu value="#{taxaInadimplenciaMB.mesInicio}"
									style="width:100px;">
									<f:selectItem itemLabel="Janeiro" itemValue="1" />
									<f:selectItem itemLabel="Fevereiro" itemValue="2" />
									<f:selectItem itemLabel="Março" itemValue="3" />
									<f:selectItem itemLabel="Abril" itemValue="4" />
									<f:selectItem itemLabel="Maio" itemValue="5" />
									<f:selectItem itemLabel="Junho" itemValue="6" />
									<f:selectItem itemLabel="Julho" itemValue="7" />
									<f:selectItem itemLabel="Agosto" itemValue="8" />
									<f:selectItem itemLabel="Setembro" itemValue="9" />
									<f:selectItem itemLabel="Outubro" itemValue="10" />
									<f:selectItem itemLabel="Novembro" itemValue="11" />
									<f:selectItem itemLabel="Dezembro" itemValue="12" />
								</p:selectOneMenu>
								<p:selectOneMenu value="#{taxaInadimplenciaMB.anoInicio}"
									style="width:80px;">
									<f:selectItem itemLabel="2010" itemValue="2010" />
									<f:selectItem itemLabel="2011" itemValue="2011" />
									<f:selectItem itemLabel="2012" itemValue="2012" />
									<f:selectItem itemLabel="2013" itemValue="2013" />
									<f:selectItem itemLabel="2014" itemValue="2014" />
									<f:selectItem itemLabel="2015" itemValue="2015" />
									<f:selectItem itemLabel="2016" itemValue="2016" />
								</p:selectOneMenu>
							</h:panelGrid>
						</p:column>

						<h:outputText value="Data Fim" />
						<p:column>
							<h:panelGrid columns="3">
								<p:selectOneMenu value="#{taxaInadimplenciaMB.mesFim}"
									style="width:100px;">
									<f:selectItem itemLabel="Janeiro" itemValue="1" />
									<f:selectItem itemLabel="Fevereiro" itemValue="2" />
									<f:selectItem itemLabel="Março" itemValue="3" />
									<f:selectItem itemLabel="Abril" itemValue="4" />
									<f:selectItem itemLabel="Maio" itemValue="5" />
									<f:selectItem itemLabel="Junho" itemValue="6" />
									<f:selectItem itemLabel="Julho" itemValue="7" />
									<f:selectItem itemLabel="Agosto" itemValue="8" />
									<f:selectItem itemLabel="Setembro" itemValue="9" />
									<f:selectItem itemLabel="Outubro" itemValue="10" />
									<f:selectItem itemLabel="Novembro" itemValue="11" />
									<f:selectItem itemLabel="Dezembro" itemValue="12" />
								</p:selectOneMenu>
								<p:selectOneMenu value="#{taxaInadimplenciaMB.anoFim}"
									style="width:80px;">
									<f:selectItem itemLabel="2010" itemValue="2010" />
									<f:selectItem itemLabel="2011" itemValue="2011" />
									<f:selectItem itemLabel="2012" itemValue="2012" />
									<f:selectItem itemLabel="2013" itemValue="2013" />
									<f:selectItem itemLabel="2014" itemValue="2014" />
									<f:selectItem itemLabel="2015" itemValue="2015" />
									<f:selectItem itemLabel="2016" itemValue="2016" />
								</p:selectOneMenu>
								<p:commandButton value="Filtrar"
									action="#{taxaInadimplenciaMB.pesquisaTaxaInadimplencia()}"
									update=":frmTblLote" onstart="PF('dlgStatus').show();"
									oncomplete="PF('dlgStatus').hide();"
									icon="fa fa-search Fs16 white" />
							</h:panelGrid>
						</p:column>
					</h:panelGrid>
				</p:panelGrid>
			</h:form>
		</div>
	</div>

	<div class="Container100 TexAlCenter">
		<div class="ContainerIndent">
			<h:form id="frmTblLote">
				<h:panelGrid style="margin:5px;" columns="2">
					<p:outputLabel value="Exportar para Excel: " />
					<h:commandLink>
						<p:graphicImage library="imagens" name="excel.png" />
						<p:dataExporter type="xls" target="tblLotes"
							fileName="taxa-inadimplencia" pageOnly="false"
							postProcessor="#{exportarBean.postProcessXLS}" />
					</h:commandLink>
				</h:panelGrid>

				<p:dataTable id="tblLotes" var="taxa"
					value="#{taxaInadimplenciaMB.listaTaxas}"
					filteredValue="#{impressaoBureauMB.fltrLotes}" rows="13"
					paginator="true" emptyMessage="Nenhum resultado encontrado!"
					style="font-size: 13px;text-align:center;"
					rowsPerPageTemplate="5,10,30,50,100">
					<f:facet name="header">
						Taxa de Inadimplência
					</f:facet>
					<p:column rendered="#{!taxaInadimplenciaMB.agruparPorMes}">
						<f:facet name="header">
							CND
						</f:facet>
						<h:outputText value="#{taxa.codigoCondominio}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							ANO
						</f:facet>
						<h:outputText value="#{taxa.anoVencimento}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							MÊS
						</f:facet>
						<h:outputText
							value="#{taxaInadimplenciaMB.nomeMes(taxa.mesVencimento)}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							QTDE EMITIDO
						</f:facet>
						<h:outputText value="#{taxa.recibo}">
							<f:convertNumber integerOnly="true" />
						</h:outputText>
					</p:column>
					<p:column>
						<f:facet name="header">
							VALOR EMITIDO
						</f:facet>
						<h:outputText value="#{taxa.reciboValor}">
							<f:convertNumber type="currency" currencySymbol="R$"
								maxFractionDigits="2" locale="pt" />
						</h:outputText>
					</p:column>
					<p:column>
						<f:facet name="header">
							QTD PAGO
						</f:facet>
						<h:outputText value="#{taxa.reciboPago}">
							<f:convertNumber integerOnly="true" />
						</h:outputText>
					</p:column>
					<p:column>
						<f:facet name="header">
							VALOR PAGO
						</f:facet>
						<h:outputText value="#{taxa.reciboValorPago}">
							<f:convertNumber type="currency" currencySymbol="R$"
								maxFractionDigits="2" locale="pt" />
						</h:outputText>
					</p:column>

					<p:column>
						<f:facet name="header">
							INADIMP. QTDE
						</f:facet>
						<h:outputText value="#{taxa.inadimplenciaQtd}">
							<f:convertNumber integerOnly="true" />
						</h:outputText>
					</p:column>

					<p:column>
						<f:facet name="header">
							INADIMP. VALOR
						</f:facet>
						<h:outputText value="#{taxa.inadimplenciaValor}">
							<f:convertNumber type="currency" currencySymbol="R$"
								maxFractionDigits="2" locale="pt" />
						</h:outputText>
					</p:column>

					<p:column>
						<f:facet name="header">
							TAXA DE QTDE
						</f:facet>
						<h:outputText value="#{taxa.porcentagemQtd}">
							<f:convertNumber maxFractionDigits="2" locale="pt" />
						</h:outputText>%
					</p:column>
					<p:column>
						<f:facet name="header">
							TAXA DE VALOR
						</f:facet>
						<h:outputText value="#{taxa.porcentagemValor}">
							<f:convertNumber maxFractionDigits="2" locale="pt" />
						</h:outputText>%
			</p:column>
				</p:dataTable>

				<p:dialog widgetVar="dlgStatus" id="dlgStatus" header="Status"
					style="font-size:13px;" resizable="false" modal="true"
					closable="false">	
					Esta pesquisa pode levar alguns segundos.<br />
					Carregando...<br />
					<br />
					<p:graphicImage library="imagens" name="loader.gif" />
					<br />
				</p:dialog>
			</h:form>
		</div>
	</div>
</ui:composition>
