<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="/WEB-INF/template.xhtml">
	<ui:define name="content">
		<style>
.tblLancamentos .ui-outputlabel {
	font-size: 12px !important;
}
</style>
		<div class="layout-portlets-box">
			<div class="DispInlBlock TexAlLeft">
				<div class="Fleft">
					<h2 class="black Fs24 FontRalewayMedium">Alterar Imagem</h2>
				</div>
			</div>
			<div class="Seperator"></div>
			<div class="Container100 Responsive100">
				<h:form id="frmImagens">
					<p:messages autoUpdate="true" />
					<p:panelGrid columns="2" style="max-width:650px;">
						<f:facet name="header">Lançamento</f:facet>
						<p:outputLabel value="Condomínio:" />
						<p:outputLabel
							value="#{trocaDeImagemMB.lancamentoSelecionado.condominio}" />
						<p:outputLabel value="Data:" />
						<p:outputLabel
							value="#{trocaDeImagemMB.lancamentoSelecionado.data}">
							<f:convertDateTime pattern="dd/MM/yyyy" locale="pt"
								timeZone="America/Sao_Paulo" />
						</p:outputLabel>
						<p:outputLabel value="Conta:" />
						<p:outputLabel
							value="#{trocaDeImagemMB.lancamentoSelecionado.conta}" />
						<p:outputLabel value="Valor:" />
						<p:outputLabel
							value="#{trocaDeImagemMB.lancamentoSelecionado.valor}">
							<f:convertNumber type="currency" currencySymbol="R$" />
						</p:outputLabel>
						<p:outputLabel value="Histórico:" />
						<p:outputLabel
							value="#{trocaDeImagemMB.lancamentoSelecionado.historico}" />
					</p:panelGrid>
					<div style="margin-top: 20px;">
						<h:panelGrid columns="2">
							<p:outputLabel value="Etiqueta:" />
							<p:inputText value="#{trocaDeImagemMB.etiqueta}">
								<p:ajax event="blur" process="@this"
									listener="#{trocaDeImagemMB.imagemExiste}"
									update=":frmEtiqueta" />
							</p:inputText>
						</h:panelGrid>
					</div>
					<p:dataTable id="tblImagens"
						value="#{trocaDeImagemMB.listaImagens}" var="imagem"
						style="width:50%;margin-top:20px;">
						<f:facet name="header">Lista de Imagens</f:facet>
						<p:column headerText="Título">
							<p:outputLabel value="#{imagem.nome_arquivo}" />
						</p:column>
						<p:column width="100" style="text-align:center;">
							<h:panelGrid columns="2" styleClass="tblAcoes">
								<p:commandButton title="Visualizar"
									icon="fa fa-search Fs16 white" oncomplete="abrirArquivo();">
									<f:setPropertyActionListener value="#{imagem}"
										target="#{trocaDeImagemMB.imagemSelecionada}" />
								</p:commandButton>
								<p:commandButton title="Excluir" icon="fa fa-trash Fs16 white"
									actionListener="#{trocaDeImagemMB.excluirImagem(imagem.id)}"
									update="@form:tblImagens">
									<p:confirm header="Confirmação"
										message="Você confirma a exclusão?"
										icon="fa fa-alert Fs16 white" />
								</p:commandButton>
							</h:panelGrid>
						</p:column>
					</p:dataTable>
					<p:confirmDialog global="true" widgetVar="dlgExclui"
						showEffect="fade" hideEffect="fade">
						<p:commandButton value="Não" type="button"
							styleClass="ui-confirmdialog-no"
							icon="ui-icon-close fa fa-close Fs14 white" />
						<p:commandButton value="Sim" type="button" ajax="false"
							styleClass="ui-confirmdialog-yes"
							icon="ui-icon-check fa fa-check Fs14 white" />
					</p:confirmDialog>

					<p:commandButton value="Voltar" ajax="false"
						action="/troca-de-imagem.xhtml?faces-redirect=true;"
						icon="fa fa-arrow-left Fs16 white"
						style="float:left;margin-top:20px;" />
				</h:form>
				<h:form id="frmDwnld" target="_blank">
					<p:commandButton id="btnDwnld" icon="fa fa-search Fs16 white"
						actionListener="#{trocaDeImagemMB.abrirArquivo()}" ajax="false"
						style="visibility:hidden;" />
				</h:form>
			</div>
		</div>
		<script>
			function abrirArquivo() {
				$("[id='frmDwnld:btnDwnld']").click();
			}
		</script>
		<p:dialog header="Imagem Encontrada" widgetVar="dlgImagem"
			modal="true" resizable="false" draggable="false" closeOnEscape="true">
			<h:form id="frmEtiqueta">
				<p:messages id="msgEtiqueta" />
				<h:panelGrid>
					<p:media player="pdf"
						value="#{ImgServiceBean.pdfLancamentoEtiquetaSiga}" width="800"
						height="400" cache="false">
						<f:param name="etiqueta" value="#{trocaDeImagemMB.etiqueta}" />
					</p:media>
				</h:panelGrid>
				<p:commandButton value="OK"
					actionListener="#{trocaDeImagemMB.adicionarImagem()}"
					icon="fa fa-check Fs16 white" update="@form,:frmImagens:tblImagens"
					style="float:right;margin-top:20px;" />
			</h:form>
		</p:dialog>
		<p:ajaxStatus onstart="PF('statusDialog').show()"
			onsuccess="PF('statusDialog').hide()" />
		<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
			closable="false" resizable="false" showHeader="false">
					Aguarde...<br />
			<br />
			<p:graphicImage library="imagens" name="loader.gif" />
		</p:dialog>
	</ui:define>
</ui:composition>